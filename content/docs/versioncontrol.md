+++
title = "模型版本控制"
description = ""
date = 2020-04-08T15:56:10+08:00
weight = 40
draft = false
bref = ""
toc = true
+++

### 背景
版本控制在传统软件开发的管理过程中发挥着重要作用。大量开发者通过Git，SVN等版本控制工具，或是GitHub等平台进行开发过程的生命周期管理。而在机器学习和深度学习开发的过程中，通常需要开发人员自行进行版本控制，大大增加了开发人员的负担和项目管理的难度。

### 版本控制的目标
#### 内容追踪
版本控制需要追踪软件开发过程中文件的内容变化，并能够对不同版本的文件内容差异进行表示。
#### 版本切换
版本控制需要记录用户提交的所有版本，并能够在不同版本之间进行切换。
#### 协同开发
版本控制需要支撑开发团队进行协同开发，包括版本的分支，合并等功能。
### 传统版本控制的局限
由于模型开发过程与传统软件开发过程有所不同，传统的版本控制工具在模型开发过程中难以发挥出理想的效果。

|  | 传统软件开发 | 模型开发 |
| ---- |  ----  | ----  |
|核心产品|代码|模型|
|核心文件|文本文件|二进制文件|
|文件规模|Byte/KB|MB/GB|
|迭代方式|文本编辑|迭代训练|

传统版本控制的核心思想是追踪文件内容的变化，在此基础上构建版本切换和协同开发机制。由于上述不同，传统版本控制工具和平台在对模型进行管理时难以实现内容变化的有效追踪，高效的版本切换和协同开发机制。

#### 内容追踪
传统版本控制对文件的文本内容变化进行追踪。如Git中可以通过git diff命令计算两个版本之间的文件内容差异。

由于模型文件并非通过文本编辑而是通过重新训练生成，且模型文件通常为二进制文件，传统的版本控制工具难以对模型文件的内容变化进行刻画和有意义的表示。

![](./xx.png)
#### 版本切换
传统版本控制工具通过对文件内容和版本差异的记录计算出目标版本的文件内容，并写入对应文件。如Git中可以通过git checkout命令切换到指定版本。

由于模型文件版本差异较大，通过传统版本控制工具进行版本记录的额外存储开销过大且通过版本切换命令计算目标版本的过程计算量较大，在版本切换的效率和存储开销方面远不如开发人员手动维护的版本记录。

![](./xx.png)
#### 协同开发
传统版本控制工具通过分支，合并，拉取更新等方式进行协同开发。例如Git中可以通过git branch，git merge，git pull等命令进行协同开发。

由于模型文件规模较大且通常为二进制文件，不同版本的合并难以进行，且远程仓库版本的拉取速度较慢。

![](./xx.png)
### MLHUB版本控制的特色
MLHUB从模型开发过程的特征出发，以模型为核心实现简单易用的版本控制机制。
#### 内容追踪
MLHUB追踪模型的版本变化，对不同版本的模型进行清晰刻画并进行有意义的版本差异表示。

![](./xx.png)
#### 版本切换
MLHUB从模型的特征出发，实现适合模型文件的版本存储和切换机制，实现节约存储空间和高效切换版本的目标。

![](./xx.png)

#### 协同开发
MLHUB基于模型的结构实现模型的解构和复用，构建适用于模型文件的分支与合并机制并降低与远程仓库的通信压力。

![](./xx.png)